// Double quotes need to be escaped by a backslash
// if embedding directly into a C file

<!DOCTYPE html>
<html>
<head>
<title>FDRS Gateway</title>
</head>
<body style='background-color: #EEEEEE;'>

<span style='color: #003366;'>

<h1>FDRS Gateway</h1>

<form>
  <div>
	<br>
  <fieldset>
    <legend>Time Set:</legend>
    <br>PC Time: <p id='pctime'></p>
    <br>
    <br>Controller Time: <p id='ctrlrtime'></p>
    <br>
	<input type='button' id='butsettime' name='butsettime' value='Set Time' onclick='btnTimePressed()'>
    </fieldset>
    <br><br>
   <fieldset>
    <legend>Debug Messages</legend>
    <textarea name='message' style='width:600px; height:100px;'>
		Future DBG messages???
	</textarea>
  </fieldset>
  </div>
</form>

<script>
  var Socket;
  var espTime = new Date();

    function init() {
      Socket = new WebSocket('ws://' + window.location.hostname + ':81/');
      Socket.onmessage = function(event) { processCommand(event); };
    }
  
  function processCommand(event) {
		var obj = JSON.parse(event.data);
  	var type = obj.type;
		if(type.localeCompare(\"cmd_time\") == 0) { 
			espTime = Date(parseInt(obj.value));
			document.getElementById('ctrlrtime').innerHTML = espTime;
		}
		else {
			console.log(type);
		}
  }

  setInterval(pcDate,1000); // Update PC time every second
  
  function pcDate() {
    document.getElementById('pctime').innerHTML = Date();
  }
  function btnTimePressed() {
    // document.getElementById("ctrlrtime").innerHTML = Date();
  }
  
  window.onload = function(event) {
      init();
    }
</script>
</body>
</html>